# 21. August 2025

## Arbeitsschritte
- VS Code Umgebung auf dem Laptop funktionsfähig eingerichtet, `.venv` aktiv.
- Current-Datenpipeline ausgeführt: `python code/make_current_gw_dataset.py --gw 2`
- Dateien erzeugt:
  - `data/cleaned_players_2025-26_team.csv` (696 Zeilen)
  - `data/current/merged_gw_like_gw2.csv` (696 Zeilen)
- Mini-Validierung im Python-Interpreter:
  - Zentrale Spalten vorhanden (u. a. `position`, `team_short`, `opp_team_short`, `is_home`, `fdr`, `gw`)
  - `now_cost` als Dezimalwert (z. B. 5.5)
  - `fdr` in dieser GW plausibel in `[2, 3, 4]`
  - `gw` = 2 in beiden Dateien
- Abgleich `bootstrap-static`: `current_gw = 1`, `next_gw = 2` → Entscheidung: Vorhersage und Teamvorschlag wird für `GW2` erstellt.

- **RF-Baseline** implementiert und ausgeführt:
  - Trainingsdaten: `data/_merged_gw_2022-23.csv`
  - Zeitlicher Split **Train: GW 1–30 · Test: GW 31–38 (effektiv 31–37)**.
  - Features (rolling, leakage-sicher via `shift(1)`): `price`, `selected`, `influence_r3`, `creativity_r3`, `threat_r3`, `ict_index_r3`, `minutes_r3`, `tp_per90_r3`.
  - Metrik (MAE) auf Test:
    - **RandomForest**: **1.055**
    - **Preis-Baseline**: **1.339**  → RF ~**21 %** besser.
  - Artefakte: 
    - `out/rf_baseline_metrics.md`
    - `out/rf_pred_points_gw2.csv` (Pred-Points für GW2).

- **Kleine Fixes**:
  - `team_short`-Merge-Kollision behoben (Dup-Spalte vor Merge entfernt).
  - Pfad-Mismatch beim Trainings-CSV (Dateiname mit `_` vor 2022-23) korrigiert.

## Reflexion
- **Datenquellen-Entscheidung:** Vaastav stellt keine Weekly-Updates mehr bereit. Darum baue ich die Current-Daten direkt aus der offiziellen FPL-API. Das macht mich unabhängig, ist reproduzierbar und zeigt Eigenleistung. Alternativen wie Drittanbieter-APIs bieten mehr Tiefe, sind aber aufwändiger und teils kostenpflichtig. Community-Dumps sind schnell, aber unsicher bezüglich Aktualität. Für August ist die FPL-API die sinnvollste Wahl.
- **Warum diese Features zuerst?** Alle Spalten sind stabil verfügbar und historisch verankert. Rolling-Varianten mit `shift(1)` verhindern Data Leakage. So entsteht eine saubere, ehrliche Baseline.
- **Metrik und Einordnung:** MAE ist leicht interpretierbar in „Punkten pro Spieler und GW“. Ein MAE von **~1.06** ist für einen ersten Durchstich solide, klar besser als Preis allein **(~1.34).** Luft nach oben bleibt, vor allem über Gegnerstärke, Minuten-Erwartung und Verfügbarkeit.
- **Risiken und Umgang:**
  - **Schema-Drift der API:** Absichern durch klare Spaltenlisten, defensive Getter, kurze Checks nach dem Download.
  - **FDR ist grob:** Reicht für MVP. Später Ersatz oder Ergänzung durch eigene Fixture-Schwere (z. B. Elo oder Wettquoten).
  - **Neulinge/Verletzte:** Neuzugänge ohne Historie und verletzte Spieler können verzerren. Nächstes Post-Processing: Verfügbarkeits-Faktor und Dämpfung für Neulinge.